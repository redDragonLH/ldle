<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>享元模式</title>
</head>
<body>

</body>
<script type="text/javascript">
  function Employee(data){
    this.employeeId = data.employeeId;
    this.ssId = data.ssId;
    this.name = data.name;
    this.occupation = data.occupation;
    this.companyName = data.companyName;
    this.companyAddress = data.companyAddress;
    this.companyCountry = data.companyCountry;

    Employee.prototype.getName = function () {
      return this.name;
    };
    Employee.prototype.getOccUpation=function(){
      return this.occupation;
    }
    Employee.prototype.getCompany = function () {
      return [this.companyName,this.companyAddress.this.companyCountry].join(".");
    };
  };
  var denOdell = new Employee({
    employeeId:1234,
    ssId:1234-5678-90,
    name:"liu",
    occupation:"judhfushv",
    companyName:"meimei",
    companyAddress:"北京",
    companyCountry:"中国",
  });
var a=denOdell.getName();
// console.log(a)
// ------------------享元模式---------------
function Person(data){
  this.ssId = data.ssId;
  this.name = data.name;
};
function Company(data){
  this.name=data.name;
  this.address = data.address;
  this.country = data.country;
};
var personFactory = (function(){
  var people = {},
      presonCount =0;

      return {
        createPerson:function(data){
          var person =people[data.ssId],
              newPerson;

              if(person){
                return person;
              }else {
                newPerson = new Person(data);
                people[newPerson.ssId] = newPerson;
                presonCount++;

                return newPerson;
              }
        },
        getPersonCount:function(){
          return presonCount;
        }

      };

}()),
companyFactory = (function(){
  var companies ={},
      companyCount =0;

      return {
        createCompany:function(data){
          var company = companies[data.name],
              newCompany;

          if(company){
            return company;
          }else{
            newCompany = new Company(data);
            companies[newCompany.name] = newCompany;
            companyCount++;

            return newCompany;
          }
        },
        getCompanyCount:function(){
          return companyCount;
        }
      }
}()),

employee = (function(){
  var employees ={},
      employeeCount = 0;

  return {
    add: function(data){
      var person = personFactory.createPerson({
        ssId:data.ssId,
        name:data.name
      }),
      company = companyFactory.createCompany({
        name:data.companyName,
        address:data.companyAddress,
        country:data.companyCountry
      });
    employees[data.employeeId]={
      employeeId:data.employeeId,
      occupation:data.occupation,
      person:person,
      company:company
    };
    employeeCount++;
  },
  getName:function(employeeId){
    return employees[employeeId].person.name;
  },
  getOccupation:function(employeeId){
    return employees[employeeId].occupation;
  },
  getCountry:function(employeeId){
    var company = employees[employeeId].company;
    return [company.name,company.address,commpany.country].join(".");
  },
  getTotalCount:function(){
    return employeeCount;
  }

    }

}());
var den1dell = employee.add({
  employeeId:1234,
  ssId:1234-5678-90,
  name:"den1",
  occupation:"111",
  companyName:"222",
  companyAddress:"333",
  companyCountry:"CN"
}),
den2dell = employee.add({
  employeeId:1233,
  ssId:1234-5678-91,
  name:"den2",
  occupation:"111",
  companyName:"222",
  companyAddress:"333",
  companyCountry:"CN"
}),
den1dell = employee.add({
  employeeId:1232,
  ssId:1234-5678-92,
  name:"den3",
  occupation:"111",
  companyName:"2222",
  companyAddress:"3333",
  companyCountry:"CN"
}),
den1dell = employee.add({
  employeeId:1231,
  ssId:1234-5678-93,
  name:"den4",
  occupation:"111",
  companyName:"222",
  companyAddress:"333",
  companyCountry:"GB"
});
console.log(personFactory.getPersonCount())
</script>
</html>
